import asyncio
import glob
import os

from . import zedub
from ..core.managers import edit_delete, edit_or_reply
from ..helpers.utils import _zedutils
from . import BOTLOG, BOTLOG_CHATID, mention

plugin_category = "ุงูุงุฏูุงุช"


config = "./config.py"
var_checker = [
    "APP_ID",
    "PM_LOGGER_GROUP_ID",
    "PRIVATE_CHANNEL_BOT_API_ID",
    "PRIVATE_GROUP_BOT_API_ID",
]
exts = ["jpg", "png", "webp", "webm", "m4a", "mp4", "mp3", "tgs"]


# ูุงููุณ ุงูุฃููุงุช ุจุงูุนุฑุจู
tz_map = {
    "ููุณุทูู": "Asia/Gaza",            
    "ุงูููู": "Asia/Aden",
    "ุงูุนุฑุงู": "Asia/Baghdad",
    "ุงูุณุนูุฏูุฉ": "Asia/Riyadh",
    "ุงูุณุนูุฏูู": "Asia/Riyadh",
    "ุณูุฑูุง": "Asia/Damascus",
    "ุงูุงูุงุฑุงุช": "Asia/Dubai",
    "ุงูุฅูุงุฑุงุช": "Asia/Dubai",
    "ูุทุฑ": "Asia/Qatar",
    "ุงููููุช": "Asia/Kuwait",
    "ุงูุจุญุฑูู": "Asia/Bahrain",
    "ุณูุทูุฉ ุนูุงู": "Asia/Muscat",
    "ุนูุงู": "Asia/Muscat",
    "ุงูุงุฑุฏู": "Asia/Amman",
    "ูุจูุงู": "Asia/Beirut",
    "ูุตุฑ": "Africa/Cairo",
    "ุงูุณูุฏุงู": "Africa/Khartoum",
    "ููุจูุง": "Africa/Tripoli",
    "ุงูุฌุฒุงุฆุฑ": "Africa/Algiers",
    "ุงููุบุฑุจ": "Africa/Casablanca",
    "ุชููุณ": "Africa/Tunis",
    "ููุฑูุชุงููุง": "Africa/Nouakchott",
    "ุงูุฑุงู": "Asia/Tehran",
    "ุชุฑููุง": "Europe/Istanbul",
    "ุงูุฑููุง": "America/New_York",     
    "ุฑูุณูุง": "Europe/Moscow",
    "ุงูุทุงููุง": "Europe/Rome",
    "ุงููุงููุง": "Europe/Berlin",
    "ูุฑูุณุง": "Europe/Paris",
    "ุงุณุจุงููุง": "Europe/Madrid",
    "ุจุฑูุทุงููุง": "Europe/London",
    "ุจูุฌููุง": "Europe/Brussels",
    "ุงููุฑููุฌ": "Europe/Oslo",
    "ุงูุตูู": "Asia/Shanghai",
    "ุงููุงุจุงู": "Asia/Tokyo",
    "ุงูููุฏ": "Asia/Kolkata",
    "ุงูุฏููุณูุง": "Asia/Jakarta",
    "ูุงููุฒูุง": "Asia/Kuala_Lumpur",
}


@zedub.zed_cmd(
    pattern="ุถุน ููุช(?: |$)([\\s\\S]*)",
    command=("ููุช", plugin_category),
    info={
        "header": "ูุชุบููุฑ ุงูููุทูุฉ ุงูุฒูููุฉ ูู ุฏุงุฎู ุชูููุฌุฑุงู.",
        "usage": [
            "{tr}ุถุน ููุช ุงูููู",
            "{tr}ุถุน ููุช ุงูุณุนูุฏูุฉ",
        ],
    },
)
async def variable(event):
    if not os.path.exists(config):
        return await edit_delete(
            event,
            "**- ุนูุฐุฑุงู .. ูุงูููุฌูุฏ ูููุงูู ูููู ููููููุฌ ๐๐**\n\n"
            "**- ููุฐู ุงูุงูุงููุฑ ุฎูุงุตูุฉ ูููุท ุจุงูููุตุจููู ุน ุงูุณููุฑููุฑ ๐๐ก**"
        )

    user_input = event.pattern_match.group(1).strip()
    if not user_input:
        return await edit_or_reply(event, "**โโฎ** `.ุถุน ููุช <ุงุณู ุงูุฏููุฉ>`")

    cat = await edit_or_reply(event, "**โโฎ ุฌูุงุฑู ุฅุนูุฏุงุฏ ุงูููุทููุฉ ุงูุฒูููุฉ ...**")

    # ุฅุฐุง ุงููุณุชุฎุฏู ูุชุจ ุฏููุฉ ุจุงูุนุฑุจู
    if user_input in tz_map:
        value = f'"{tz_map[user_input]}"'
    else:
        # ุฅุฐุง ูุชุจ ููุทูุฉ ุฒูููุฉ ุฌุงูุฒุฉ
        value = f'"{user_input}"'

    variable = "TZ"

    with open(config, "r") as f:
        configs = f.readlines()

    string = ""
    match = False
    for i in configs:
        if i.strip().startswith(f"{variable} "):
            string += f'{variable} = {value}\n'
            match = True
        else:
            string += i

    if not match:
        string += f'{variable} = {value}\n'

    with open(config, "w") as f1:
        f1.write(string)

    await cat.edit(
        f"**- ุชู ุชุบูููุฑ ุงูููุทูุฉ ุงูุฒูููุฉ ุฅูู :** `{value}` โ\n\n"
        "**- ูุชู ุงูุงู ุงุนูุงุฏุฉ ุชุดุบููู ุจููุช ููู ุซูู ...**\n**ูุณุชุบูุฑู ุงูุงูุฑ 5-8 ุฏููููู โฌโญ ...**"
    )

    await event.client.reload(cat)
    
#ุญููู ุงูุงุณุทูุฑู ุนุงุดู ุงูุตูุช 
#ุณูุฑุณ ูููุซูู ๐พ๐ช

ASHEQ_ALSAMT_cmd = (
    "๐ฉ ๐๐ผ๐๐๐๐๐๐๐ ๐ง๐ถ๐บ๐ฒ **๐ข ุงูููุทูุฉ ุงูุฒูููุฉ** ๐ช\n"
    "**โโโโโโโโโโโโโโโโโ**\n"
    "**โง ูุงุฆููุฉ ุงูุงูุฑ ุชุบูููุฑ ุงูููุทููุฉ ุงูุฒููููุฉ ูู ุถุจุท ุงูููุช ุน ูููุซููู ุญุณุจ ุชูููุช ุฏููุชู ๐:** \n\n"
    "โชผ `.ุถุน ููุช ููุณุทูู` \n"
    "โชผ `.ุถุน ููุช ุงูููู` \n"
    "โชผ `.ุถุน ููุช ุงูุนุฑุงู` \n"
    "โชผ `.ุถุน ููุช ุงูุณุนูุฏูุฉ` \n"
    "โชผ `.ุถุน ููุช ุณูุฑูุง` \n"
    "โชผ `.ุถุน ููุช ุงูุงูุงุฑุงุช` \n"
    "โชผ `.ุถุน ููุช ูุทุฑ` \n"
    "โชผ `.ุถุน ููุช ุงููููุช` \n"
    "โชผ `.ุถุน ููุช ุงูุจุญุฑูู` \n"
    "โชผ `.ุถุน ููุช ุณูุทูุฉ ุนูุงู` \n"
    "โชผ `.ุถุน ููุช ุงูุงุฑุฏู` \n"
    "โชผ `.ุถุน ููุช ูุจูุงู` \n"
    "โชผ `.ุถุน ููุช ูุตุฑ` \n"
    "โชผ `.ุถุน ููุช ุงูุณูุฏุงู` \n"
    "โชผ `.ุถุน ููุช ููุจูุง` \n"
    "โชผ `.ุถุน ููุช ุงูุฌุฒุงุฆุฑ` \n"
    "โชผ `.ุถุน ููุช ุงููุบุฑุจ` \n"
    "โชผ `.ุถุน ููุช ุชููุณ` \n"
    "โชผ `.ุถุน ููุช ููุฑูุชุงููุง` \n"
    "โชผ `.ุถุน ููุช ุงูุฑุงู` \n"
    "โชผ `.ุถุน ููุช ุชุฑููุง` \n"
    "โชผ `.ุถุน ููุช ุงูุฑููุง` \n"
    "โชผ `.ุถุน ููุช ุฑูุณูุง` \n"
    "โชผ `.ุถุน ููุช ุงูุทุงููุง` \n"
    "โชผ `.ุถุน ููุช ุงููุงููุง` \n"
    "โชผ `.ุถุน ููุช ูุฑูุณุง` \n"
    "โชผ `.ุถุน ููุช ุงุณุจุงููุง` \n"
    "โชผ `.ุถุน ููุช ุจุฑูุทุงููุง` \n"
    "โชผ `.ุถุน ููุช ุจูุฌููุง` \n"
    "โชผ `.ุถุน ููุช ุงููุฑููุฌ` \n"
    "โชผ `.ุถุน ููุช ุงูุตูู` \n"
    "โชผ `.ุถุน ููุช ุงููุงุจุงู` \n"
    "โชผ `.ุถุน ููุช ุงูููุฏ` \n"
    "โชผ `.ุถุน ููุช ุงูุฏููุณูุง` \n"
    "โชผ `.ุถุน ููุช ูุงููุฒูุง` \n\n"
    "**๐ ุงุฐุง ูู ุชุฌุฏ ุฏููุชู .. ูู ุจุงูุจุญุซ ุนู ุงูุฑุจ ุฏููู ููุง**\n"
    "๐ฉ [๐๐ผ๐๐๐๐๐๐๐ ๐ฉ๐ฎ๐ฟ๐ - ูููุงุฉ ุงูููุงุฑุงุช](t.me/YamenThon_vars) ๐ช"
)



@zedub.zed_cmd(pattern="ุงูููุช")
async def cmd(zelzallltm):
    await edit_or_reply(zelzallltm, ASHEQ_ALSAMT_cmd)
